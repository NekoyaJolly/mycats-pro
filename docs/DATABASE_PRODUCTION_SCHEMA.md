# ğŸ—„ï¸ æœ¬ç•ªç’°å¢ƒãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒè©³ç´°

## ğŸ“‹ æ¦‚è¦

æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€çŒ«ç”Ÿä½“ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ï¼ˆMy Catsï¼‰ã‚’æœ¬ç•ªç’°å¢ƒã«ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãŸéš›ã«ã€Prismaã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚Œã‚‹PostgreSQLãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®å®Œå…¨ãªã‚¹ã‚­ãƒ¼ãƒå®šç¾©ã€ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ ã€ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¨­è¨ˆã‚’è©³è¿°ã—ã¦ã„ã¾ã™ã€‚

### ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±

- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: PostgreSQL 15+
- **ORM**: Prisma 6.14.0
- **ã‚¹ã‚­ãƒ¼ãƒãƒ•ã‚¡ã‚¤ãƒ«**: `backend/prisma/schema.prisma`
- **ç”Ÿæˆæ—¥**: 2025å¹´1æœˆï¼ˆæœ¬ç•ªç’°å¢ƒãƒ‡ãƒ—ãƒ­ã‚¤æ™‚ç‚¹ï¼‰

---

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å…¨ä½“æ§‹æˆ

### ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§ï¼ˆ15ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰

| No. | ãƒ†ãƒ¼ãƒ–ãƒ«å           | ç‰©ç†å                   | æ¦‚è¦                       |
| --- | -------------------- | ------------------------ | -------------------------- |
| 1   | ãƒ¦ãƒ¼ã‚¶ãƒ¼             | `users`                  | ã‚·ã‚¹ãƒ†ãƒ åˆ©ç”¨è€…ã®ç®¡ç†       |
| 2   | ãƒ­ã‚°ã‚¤ãƒ³è©¦è¡Œ         | `login_attempts`         | ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»ãƒ­ã‚°       |
| 3   | çŒ«ç¨®ãƒã‚¹ã‚¿           | `breeds`                 | çŒ«ã®å“ç¨®ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿       |
| 4   | æ¯›è‰²ãƒã‚¹ã‚¿           | `coat_colors`            | æ¯›è‰²ã®åˆ†é¡ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿     |
| 5   | çŒ«åŸºæœ¬æƒ…å ±           | `cats`                   | çŒ«ã®å€‹ä½“æƒ…å ±               |
| 6   | äº¤é…è¨˜éŒ²             | `breeding_records`       | äº¤é…ãƒ»ç¹æ®–å±¥æ­´             |
| 7   | ã‚±ã‚¢è¨˜éŒ²             | `care_records`           | åŒ»ç™‚ãƒ»ã‚±ã‚¢å±¥æ­´             |
| 8   | ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«         | `schedules`              | äºˆå®šãƒ»ã‚¿ã‚¹ã‚¯ç®¡ç†           |
| 9   | ã‚¿ã‚°ã‚«ãƒ†ã‚´ãƒª         | `tag_categories`         | ã‚¿ã‚°ã®åˆ†é¡ã‚«ãƒ†ã‚´ãƒª         |
| 10  | ã‚¿ã‚°ãƒã‚¹ã‚¿           | `tags`                   | ã‚«ãƒ†ã‚´ãƒªé…ä¸‹ã®ã‚¿ã‚°å®šç¾©     |
| 11  | ã‚¿ã‚°è‡ªå‹•åŒ–ãƒ«ãƒ¼ãƒ«     | `tag_automation_rules`   | ã‚¿ã‚°è‡ªå‹•ä»˜ä¸ã®ãƒ«ãƒ¼ãƒ«ç®¡ç†   |
| 12  | ã‚¿ã‚°è‡ªå‹•åŒ–å®Ÿè¡Œ       | `tag_automation_runs`    | è‡ªå‹•ä»˜ä¸ã®å®Ÿè¡Œå±¥æ­´         |
| 13  | ã‚¿ã‚°ä»˜ä¸å±¥æ­´         | `tag_assignment_history` | æ‰‹å‹•/è‡ªå‹•ã‚¿ã‚°æ“ä½œã®å±¥æ­´ç®¡ç† |
| 14  | çŒ«ã‚¿ã‚°é–¢é€£           | `cat_tags`               | çŒ«ã¨ã‚¿ã‚°ã®å¤šå¯¾å¤šé–¢é€£       |
| 15  | è¡€çµ±æƒ…å ±             | `pedigrees`              | è¡€çµ±æ›¸ãƒ»å®¶ç³»å›³ãƒ‡ãƒ¼ã‚¿       |


---

## ğŸ”‘ ä¸»è¦ãƒ†ãƒ¼ãƒ–ãƒ«è©³ç´°

### 1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆusersï¼‰

**æ¦‚è¦**: ã‚·ã‚¹ãƒ†ãƒ åˆ©ç”¨è€…ã®åŸºæœ¬æƒ…å ±ã¨èªè¨¼ãƒ‡ãƒ¼ã‚¿ã‚’ç®¡ç†

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å         | ç‰©ç†å                  | ãƒ‡ãƒ¼ã‚¿å‹ | NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜                     |
| -------------------- | ----------------------- | -------- | ---- | ---------- | ------------------------ |
| ID                   | `id`                    | String   | âœ—    | uuid()     | ä¸»ã‚­ãƒ¼ï¼ˆUUIDï¼‰           |
| Clerk ID             | `clerk_id`              | String   | âœ—    | -          | å¤–éƒ¨èªè¨¼ã‚µãƒ¼ãƒ“ã‚¹ID       |
| ãƒ¡ãƒ¼ãƒ«               | `email`                 | String   | âœ—    | -          | ãƒ­ã‚°ã‚¤ãƒ³ç”¨ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ |
| åå‰ï¼ˆå§“ï¼‰           | `first_name`            | String   | âœ“    | -          | ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å§“             |
| åå‰ï¼ˆåï¼‰           | `last_name`             | String   | âœ“    | -          | ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å             |
| ãƒ­ãƒ¼ãƒ«               | `role`                  | UserRole | âœ—    | USER       | æ¨©é™ãƒ¬ãƒ™ãƒ«               |
| æœ‰åŠ¹ãƒ•ãƒ©ã‚°           | `is_active`             | Boolean  | âœ—    | true       | ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæœ‰åŠ¹æ€§         |
| ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥   | `password_hash`         | String   | âœ“    | -          | ãƒãƒƒã‚·ãƒ¥åŒ–ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰     |
| ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ | `refresh_token`         | String   | âœ“    | -          | JWTæ›´æ–°ç”¨ãƒˆãƒ¼ã‚¯ãƒ³        |
| ãƒ­ã‚°ã‚¤ãƒ³å¤±æ•—å›æ•°     | `failed_login_attempts` | Int      | âœ—    | 0          | ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç”¨ã‚«ã‚¦ãƒ³ã‚¿   |
| ãƒ­ãƒƒã‚¯æœŸé™           | `locked_until`          | DateTime | âœ“    | -          | ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ãƒƒã‚¯è§£é™¤æ™‚åˆ» |
| æœ€çµ‚ãƒ­ã‚°ã‚¤ãƒ³         | `last_login_at`         | DateTime | âœ“    | -          | æœ€å¾Œã®ãƒ­ã‚°ã‚¤ãƒ³æ™‚åˆ»       |
| ä½œæˆæ—¥æ™‚             | `created_at`            | DateTime | âœ—    | now()      | ãƒ¬ã‚³ãƒ¼ãƒ‰ä½œæˆæ—¥æ™‚         |
| æ›´æ–°æ—¥æ™‚             | `updated_at`            | DateTime | âœ—    | -          | ãƒ¬ã‚³ãƒ¼ãƒ‰æ›´æ–°æ—¥æ™‚         |

**åˆ¶ç´„**:

- ä¸»ã‚­ãƒ¼: `id`
- ãƒ¦ãƒ‹ãƒ¼ã‚¯åˆ¶ç´„: `clerk_id`, `email`

**ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³**:

- â†’ catsï¼ˆ1å¯¾å¤šï¼‰: æ‰€æœ‰ã™ã‚‹çŒ«
- â†’ breeding_recordsï¼ˆ1å¯¾å¤šï¼‰: è¨˜éŒ²ã—ãŸäº¤é…å±¥æ­´
- â†’ care_recordsï¼ˆ1å¯¾å¤šï¼‰: è¨˜éŒ²ã—ãŸã‚±ã‚¢å±¥æ­´
- â†’ schedulesï¼ˆ1å¯¾å¤šï¼‰: æ‹…å½“ã™ã‚‹ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«
- â†’ login_attemptsï¼ˆ1å¯¾å¤šï¼‰: ãƒ­ã‚°ã‚¤ãƒ³è©¦è¡Œå±¥æ­´

### 2. ãƒ­ã‚°ã‚¤ãƒ³è©¦è¡Œï¼ˆlogin_attemptsï¼‰

**æ¦‚è¦**: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»ã®ãŸã‚ã®ãƒ­ã‚°ã‚¤ãƒ³è©¦è¡Œãƒ­ã‚°

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å         | ç‰©ç†å       | ãƒ‡ãƒ¼ã‚¿å‹ | NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜                     |
| -------------------- | ------------ | -------- | ---- | ---------- | ------------------------ |
| ID                   | `id`         | String   | âœ—    | uuid()     | ä¸»ã‚­ãƒ¼ï¼ˆUUIDï¼‰           |
| ãƒ¦ãƒ¼ã‚¶ãƒ¼ID           | `user_id`    | String   | âœ“    | -          | å¯¾è±¡ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆå¤–éƒ¨ã‚­ãƒ¼ï¼‰ |
| ãƒ¡ãƒ¼ãƒ«               | `email`      | String   | âœ—    | -          | è©¦è¡Œã•ã‚ŒãŸãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ |
| IPã‚¢ãƒ‰ãƒ¬ã‚¹           | `ip_address` | String   | âœ“    | -          | ã‚¢ã‚¯ã‚»ã‚¹å…ƒIP             |
| ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ | `user_agent` | String   | âœ“    | -          | ãƒ–ãƒ©ã‚¦ã‚¶æƒ…å ±             |
| æˆåŠŸãƒ•ãƒ©ã‚°           | `success`    | Boolean  | âœ—    | -          | ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸ/å¤±æ•—        |
| å¤±æ•—ç†ç”±             | `reason`     | String   | âœ“    | -          | å¤±æ•—æ™‚ã®ç†ç”±             |
| è©¦è¡Œæ—¥æ™‚             | `created_at` | DateTime | âœ—    | now()      | ãƒ­ã‚°ã‚¤ãƒ³è©¦è¡Œæ—¥æ™‚         |

**åˆ¶ç´„**:

- ä¸»ã‚­ãƒ¼: `id`
- å¤–éƒ¨ã‚­ãƒ¼: `user_id` â†’ users.idï¼ˆCASCADEå‰Šé™¤ï¼‰

### 3. çŒ«ç¨®ãƒã‚¹ã‚¿ï¼ˆbreedsï¼‰

**æ¦‚è¦**: çŒ«ã®å“ç¨®ã‚’ç®¡ç†ã™ã‚‹ãƒã‚¹ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å | ç‰©ç†å        | ãƒ‡ãƒ¼ã‚¿å‹ | NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜                  |
| ------------ | ------------- | -------- | ---- | ---------- | --------------------- |
| ID           | `id`          | String   | âœ—    | uuid()     | ä¸»ã‚­ãƒ¼ï¼ˆUUIDï¼‰        |
| çŒ«ç¨®ã‚³ãƒ¼ãƒ‰   | `code`        | Int      | âœ—    | -          | æ•°å€¤ã‚³ãƒ¼ãƒ‰ï¼ˆCSVã‹ã‚‰ï¼‰ |
| çŒ«ç¨®å       | `name`        | String   | âœ—    | -          | å“ç¨®åç§°              |
| èª¬æ˜         | `description` | String   | âœ“    | -          | å“ç¨®ã®è©³ç´°èª¬æ˜        |
| æœ‰åŠ¹ãƒ•ãƒ©ã‚°   | `is_active`   | Boolean  | âœ—    | true       | ãƒã‚¹ã‚¿ã®æœ‰åŠ¹æ€§        |
| ä½œæˆæ—¥æ™‚     | `created_at`  | DateTime | âœ—    | now()      | ãƒ¬ã‚³ãƒ¼ãƒ‰ä½œæˆæ—¥æ™‚      |
| æ›´æ–°æ—¥æ™‚     | `updated_at`  | DateTime | âœ—    | -          | ãƒ¬ã‚³ãƒ¼ãƒ‰æ›´æ–°æ—¥æ™‚      |

**åˆ¶ç´„**:

- ä¸»ã‚­ãƒ¼: `id`
- ãƒ¦ãƒ‹ãƒ¼ã‚¯åˆ¶ç´„: `code`, `name`

**ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³**:

- â†’ catsï¼ˆ1å¯¾å¤šï¼‰: ã“ã®å“ç¨®ã®çŒ«
- â†’ pedigreesï¼ˆ1å¯¾å¤šï¼‰: ã“ã®å“ç¨®ã®è¡€çµ±è¨˜éŒ²

### 4. æ¯›è‰²ãƒã‚¹ã‚¿ï¼ˆcoat_colorsï¼‰

**æ¦‚è¦**: çŒ«ã®æ¯›è‰²ã‚’ç®¡ç†ã™ã‚‹ãƒã‚¹ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å | ç‰©ç†å        | ãƒ‡ãƒ¼ã‚¿å‹ | NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜                  |
| ------------ | ------------- | -------- | ---- | ---------- | --------------------- |
| ID           | `id`          | String   | âœ—    | uuid()     | ä¸»ã‚­ãƒ¼ï¼ˆUUIDï¼‰        |
| æ¯›è‰²ã‚³ãƒ¼ãƒ‰   | `code`        | Int      | âœ—    | -          | æ•°å€¤ã‚³ãƒ¼ãƒ‰ï¼ˆCSVã‹ã‚‰ï¼‰ |
| æ¯›è‰²å       | `name`        | String   | âœ—    | -          | æ¯›è‰²åç§°              |
| èª¬æ˜         | `description` | String   | âœ“    | -          | æ¯›è‰²ã®è©³ç´°èª¬æ˜        |
| æœ‰åŠ¹ãƒ•ãƒ©ã‚°   | `is_active`   | Boolean  | âœ—    | true       | ãƒã‚¹ã‚¿ã®æœ‰åŠ¹æ€§        |
| ä½œæˆæ—¥æ™‚     | `created_at`  | DateTime | âœ—    | now()      | ãƒ¬ã‚³ãƒ¼ãƒ‰ä½œæˆæ—¥æ™‚      |
| æ›´æ–°æ—¥æ™‚     | `updated_at`  | DateTime | âœ—    | -          | ãƒ¬ã‚³ãƒ¼ãƒ‰æ›´æ–°æ—¥æ™‚      |

**åˆ¶ç´„**:

- ä¸»ã‚­ãƒ¼: `id`
- ãƒ¦ãƒ‹ãƒ¼ã‚¯åˆ¶ç´„: `code`, `name`

**ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³**:

- â†’ catsï¼ˆ1å¯¾å¤šï¼‰: ã“ã®æ¯›è‰²ã®çŒ«
- â†’ pedigreesï¼ˆ1å¯¾å¤šï¼‰: ã“ã®æ¯›è‰²ã®è¡€çµ±è¨˜éŒ²

### 5. çŒ«åŸºæœ¬æƒ…å ±ï¼ˆcatsï¼‰

**æ¦‚è¦**: çŒ«ã®å€‹ä½“æƒ…å ±ã¨åŸºæœ¬ãƒ‡ãƒ¼ã‚¿ã‚’ç®¡ç†ã™ã‚‹ä¸­æ ¸ãƒ†ãƒ¼ãƒ–ãƒ«

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å     | ç‰©ç†å            | ãƒ‡ãƒ¼ã‚¿å‹ | NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜               |
| ---------------- | ----------------- | -------- | ---- | ---------- | ------------------ |
| ID               | `id`              | String   | âœ—    | uuid()     | ä¸»ã‚­ãƒ¼ï¼ˆUUIDï¼‰     |
| ç™»éŒ²ID           | `registration_id` | String   | âœ—    | -          | ä¸€æ„ã®ç™»éŒ²ç•ªå·     |
| åå‰             | `name`            | String   | âœ—    | -          | çŒ«ã®åå‰           |
| çŒ«ç¨®ID           | `breed_id`        | String   | âœ“    | -          | å“ç¨®ï¼ˆå¤–éƒ¨ã‚­ãƒ¼ï¼‰   |
| æ¯›è‰²ID           | `color_id`        | String   | âœ“    | -          | æ¯›è‰²ï¼ˆå¤–éƒ¨ã‚­ãƒ¼ï¼‰   |
| å¾“æ¥çŒ«ç¨®         | `legacy_breed`    | String   | âœ“    | -          | æ—§ã‚·ã‚¹ãƒ†ãƒ ç”¨å“ç¨®   |
| å¾“æ¥æ¯›è‰²         | `legacy_color`    | String   | âœ“    | -          | æ—§ã‚·ã‚¹ãƒ†ãƒ ç”¨æ¯›è‰²   |
| æ¨¡æ§˜             | `pattern`         | String   | âœ“    | -          | æ¯›è‰²ã®æ¨¡æ§˜è©³ç´°     |
| æ€§åˆ¥             | `gender`          | Gender   | âœ—    | -          | ã‚ªã‚¹/ãƒ¡ã‚¹          |
| ç”Ÿå¹´æœˆæ—¥         | `birth_date`      | DateTime | âœ—    | -          | èª•ç”Ÿæ—¥             |
| ä½“é‡             | `weight`          | Float    | âœ“    | -          | ä½“é‡ï¼ˆkgï¼‰         |
| ãƒã‚¤ã‚¯ãƒ­ãƒãƒƒãƒ—ID | `microchip_id`    | String   | âœ“    | -          | å€‹ä½“è­˜åˆ¥ãƒãƒƒãƒ—     |
| æœ‰åŠ¹ãƒ•ãƒ©ã‚°       | `is_active`       | Boolean  | âœ—    | true       | çŒ«ã®ç®¡ç†çŠ¶æ…‹       |
| å‚™è€ƒ             | `notes`           | String   | âœ“    | -          | ãã®ä»–æƒ…å ±         |
| ç”»åƒURL          | `image_url`       | String   | âœ“    | -          | å†™çœŸã¸ã®ãƒªãƒ³ã‚¯     |
| çˆ¶è¦ªID           | `father_id`       | String   | âœ“    | -          | çˆ¶è¦ªçŒ«ï¼ˆå¤–éƒ¨ã‚­ãƒ¼ï¼‰ |
| æ¯è¦ªID           | `mother_id`       | String   | âœ“    | -          | æ¯è¦ªçŒ«ï¼ˆå¤–éƒ¨ã‚­ãƒ¼ï¼‰ |
| é£¼ã„ä¸»ID         | `owner_id`        | String   | âœ—    | -          | æ‰€æœ‰è€…ï¼ˆå¤–éƒ¨ã‚­ãƒ¼ï¼‰ |
| ä½œæˆæ—¥æ™‚         | `created_at`      | DateTime | âœ—    | now()      | ãƒ¬ã‚³ãƒ¼ãƒ‰ä½œæˆæ—¥æ™‚   |
| æ›´æ–°æ—¥æ™‚         | `updated_at`      | DateTime | âœ—    | -          | ãƒ¬ã‚³ãƒ¼ãƒ‰æ›´æ–°æ—¥æ™‚   |

**åˆ¶ç´„**:

- ä¸»ã‚­ãƒ¼: `id`
- ãƒ¦ãƒ‹ãƒ¼ã‚¯åˆ¶ç´„: `registration_id`, `microchip_id`
- å¤–éƒ¨ã‚­ãƒ¼: `breed_id` â†’ breeds.id, `color_id` â†’ coat_colors.id
- å¤–éƒ¨ã‚­ãƒ¼: `father_id` â†’ cats.id, `mother_id` â†’ cats.id
- å¤–éƒ¨ã‚­ãƒ¼: `owner_id` â†’ users.id

**è‡ªå·±å‚ç…§ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³**:

- â†’ fatherï¼ˆå¤šå¯¾1ï¼‰: çˆ¶è¦ªçŒ«
- â†’ motherï¼ˆå¤šå¯¾1ï¼‰: æ¯è¦ªçŒ«
- â†’ fatherOfï¼ˆ1å¯¾å¤šï¼‰: çˆ¶è¦ªã¨ã—ã¦é–¢ã‚ã‚‹å­çŒ«
- â†’ motherOfï¼ˆ1å¯¾å¤šï¼‰: æ¯è¦ªã¨ã—ã¦é–¢ã‚ã‚‹å­çŒ«

**ãã®ä»–ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³**:

- â†’ maleBreedingRecordsï¼ˆ1å¯¾å¤šï¼‰: ã‚ªã‚¹ã¨ã—ã¦ã®äº¤é…è¨˜éŒ²
- â†’ femaleBreedingRecordsï¼ˆ1å¯¾å¤šï¼‰: ãƒ¡ã‚¹ã¨ã—ã¦ã®äº¤é…è¨˜éŒ²
- â†’ careRecordsï¼ˆ1å¯¾å¤šï¼‰: ã‚±ã‚¢å±¥æ­´
- â†’ schedulesï¼ˆ1å¯¾å¤šï¼‰: ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«
- â†’ tagsï¼ˆå¤šå¯¾å¤šã€cat_tagsçµŒç”±ï¼‰: ã‚¿ã‚°
- â†’ pedigreesï¼ˆ1å¯¾å¤šï¼‰: è¡€çµ±è¨˜éŒ²

### 6. äº¤é…è¨˜éŒ²ï¼ˆbreeding_recordsï¼‰

**æ¦‚è¦**: çŒ«ã®äº¤é…ãƒ»ç¹æ®–æ´»å‹•ã®å±¥æ­´ã‚’ç®¡ç†

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å | ç‰©ç†å              | ãƒ‡ãƒ¼ã‚¿å‹       | NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜               |
| ------------ | ------------------- | -------------- | ---- | ---------- | ------------------ |
| ID           | `id`                | String         | âœ—    | uuid()     | ä¸»ã‚­ãƒ¼ï¼ˆUUIDï¼‰     |
| ã‚ªã‚¹çŒ«ID     | `male_id`           | String         | âœ—    | -          | çˆ¶è¦ªçŒ«ï¼ˆå¤–éƒ¨ã‚­ãƒ¼ï¼‰ |
| ãƒ¡ã‚¹çŒ«ID     | `female_id`         | String         | âœ—    | -          | æ¯è¦ªçŒ«ï¼ˆå¤–éƒ¨ã‚­ãƒ¼ï¼‰ |
| äº¤é…æ—¥       | `breeding_date`     | DateTime       | âœ—    | -          | å®Ÿéš›ã®äº¤é…æ—¥       |
| äºˆå®šå‡ºç”£æ—¥   | `expected_due_date` | DateTime       | âœ“    | -          | è¨ˆç®—ä¸Šã®å‡ºç”£äºˆå®šæ—¥ |
| å®Ÿéš›å‡ºç”£æ—¥   | `actual_due_date`   | DateTime       | âœ“    | -          | å®Ÿéš›ã®å‡ºç”£æ—¥       |
| å­çŒ«æ•°       | `number_of_kittens` | Int            | âœ“    | -          | ç”Ÿã¾ã‚ŒãŸå­çŒ«ã®æ•°   |
| å‚™è€ƒ         | `notes`             | String         | âœ“    | -          | äº¤é…ã«é–¢ã™ã‚‹è©³ç´°   |
| ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹   | `status`            | BreedingStatus | âœ—    | PLANNED    | äº¤é…ã®é€²è¡ŒçŠ¶æ³     |
| è¨˜éŒ²è€…ID     | `recorded_by`       | String         | âœ—    | -          | è¨˜éŒ²ã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼   |
| ä½œæˆæ—¥æ™‚     | `created_at`        | DateTime       | âœ—    | now()      | ãƒ¬ã‚³ãƒ¼ãƒ‰ä½œæˆæ—¥æ™‚   |
| æ›´æ–°æ—¥æ™‚     | `updated_at`        | DateTime       | âœ—    | -          | ãƒ¬ã‚³ãƒ¼ãƒ‰æ›´æ–°æ—¥æ™‚   |

**åˆ¶ç´„**:

- ä¸»ã‚­ãƒ¼: `id`
- å¤–éƒ¨ã‚­ãƒ¼: `male_id` â†’ cats.id, `female_id` â†’ cats.id
- å¤–éƒ¨ã‚­ãƒ¼: `recorded_by` â†’ users.id

### 7. ã‚±ã‚¢è¨˜éŒ²ï¼ˆcare_recordsï¼‰

**æ¦‚è¦**: çŒ«ã®åŒ»ç™‚ãƒ»ã‚±ã‚¢æ´»å‹•ã®å±¥æ­´ã‚’ç®¡ç†

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å | ç‰©ç†å          | ãƒ‡ãƒ¼ã‚¿å‹ | NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜               |
| ------------ | --------------- | -------- | ---- | ---------- | ------------------ |
| ID           | `id`            | String   | âœ—    | uuid()     | ä¸»ã‚­ãƒ¼ï¼ˆUUIDï¼‰     |
| çŒ«ID         | `cat_id`        | String   | âœ—    | -          | å¯¾è±¡çŒ«ï¼ˆå¤–éƒ¨ã‚­ãƒ¼ï¼‰ |
| ã‚±ã‚¢ç¨®åˆ¥     | `care_type`     | CareType | âœ—    | -          | ã‚±ã‚¢ã®åˆ†é¡         |
| è©³ç´°         | `description`   | String   | âœ—    | -          | ã‚±ã‚¢å†…å®¹ã®èª¬æ˜     |
| ã‚±ã‚¢æ—¥       | `care_date`     | DateTime | âœ—    | -          | å®Ÿæ–½æ—¥             |
| æ¬¡å›äºˆå®šæ—¥   | `next_due_date` | DateTime | âœ“    | -          | æ¬¡å›ã®äºˆå®šæ—¥       |
| è²»ç”¨         | `cost`          | Float    | âœ“    | -          | ã‹ã‹ã£ãŸè²»ç”¨       |
| ç£åŒ»å¸«       | `veterinarian`  | String   | âœ“    | -          | æ‹…å½“ç£åŒ»å¸«å       |
| å‚™è€ƒ         | `notes`         | String   | âœ“    | -          | ãã®ä»–è©³ç´°         |
| è¨˜éŒ²è€…ID     | `recorded_by`   | String   | âœ—    | -          | è¨˜éŒ²ã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼   |
| ä½œæˆæ—¥æ™‚     | `created_at`    | DateTime | âœ—    | now()      | ãƒ¬ã‚³ãƒ¼ãƒ‰ä½œæˆæ—¥æ™‚   |
| æ›´æ–°æ—¥æ™‚     | `updated_at`    | DateTime | âœ—    | -          | ãƒ¬ã‚³ãƒ¼ãƒ‰æ›´æ–°æ—¥æ™‚   |

**åˆ¶ç´„**:

- ä¸»ã‚­ãƒ¼: `id`
- å¤–éƒ¨ã‚­ãƒ¼: `cat_id` â†’ cats.id, `recorded_by` â†’ users.id

### 8. ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆschedulesï¼‰

**æ¦‚è¦**: ã‚±ã‚¢ã‚„äº¤é…ãªã©ã®äºˆå®šãƒ»ã‚¿ã‚¹ã‚¯ã‚’ç®¡ç†

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å     | ç‰©ç†å          | ãƒ‡ãƒ¼ã‚¿å‹       | NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜               |
| ---------------- | --------------- | -------------- | ---- | ---------- | ------------------ |
| ID               | `id`            | String         | âœ—    | uuid()     | ä¸»ã‚­ãƒ¼ï¼ˆUUIDï¼‰     |
| ã‚¿ã‚¤ãƒˆãƒ«         | `title`         | String         | âœ—    | -          | ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«å     |
| è©³ç´°             | `description`   | String         | âœ“    | -          | è©³ç´°èª¬æ˜           |
| äºˆå®šæ—¥æ™‚         | `schedule_date` | DateTime       | âœ—    | -          | å®Ÿè¡Œäºˆå®šæ—¥æ™‚       |
| ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç¨®åˆ¥ | `schedule_type` | ScheduleType   | âœ—    | -          | äºˆå®šã®åˆ†é¡         |
| ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹       | `status`        | ScheduleStatus | âœ—    | PENDING    | é€²è¡ŒçŠ¶æ³           |
| å„ªå…ˆåº¦           | `priority`      | Priority       | âœ—    | MEDIUM     | é‡è¦åº¦ãƒ¬ãƒ™ãƒ«       |
| çŒ«ID             | `cat_id`        | String         | âœ“    | -          | å¯¾è±¡çŒ«ï¼ˆå¤–éƒ¨ã‚­ãƒ¼ï¼‰ |
| æ‹…å½“è€…ID         | `assigned_to`   | String         | âœ—    | -          | æ‹…å½“ãƒ¦ãƒ¼ã‚¶ãƒ¼       |
| ä½œæˆæ—¥æ™‚         | `created_at`    | DateTime       | âœ—    | now()      | ãƒ¬ã‚³ãƒ¼ãƒ‰ä½œæˆæ—¥æ™‚   |
| æ›´æ–°æ—¥æ™‚         | `updated_at`    | DateTime       | âœ—    | -          | ãƒ¬ã‚³ãƒ¼ãƒ‰æ›´æ–°æ—¥æ™‚   |

**åˆ¶ç´„**:

- ä¸»ã‚­ãƒ¼: `id`
- å¤–éƒ¨ã‚­ãƒ¼: `cat_id` â†’ cats.id, `assigned_to` â†’ users.id

### 9. ã‚¿ã‚°ã‚«ãƒ†ã‚´ãƒªï¼ˆtag_categoriesï¼‰

**æ¦‚è¦**: ã‚¿ã‚°ã‚’ã‚«ãƒ†ã‚´ãƒªå˜ä½ã§æ•´ç†ã—ã€å¯¾è±¡ã‚¹ã‚³ãƒ¼ãƒ—ã‚„è¡¨ç¤ºé †ã‚’ç®¡ç†

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å     | ç‰©ç†å           | ãƒ‡ãƒ¼ã‚¿å‹ | NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜                     |
| ---------------- | ---------------- | -------- | ---- | ---------- | ------------------------ |
| ID               | `id`             | String   | âœ—    | uuid()     | ä¸»ã‚­ãƒ¼ï¼ˆUUIDï¼‰           |
| ã‚­ãƒ¼             | `key`            | String   | âœ—    | -          | ä¸€æ„ãªã‚«ãƒ†ã‚´ãƒªã‚­ãƒ¼       |
| åç§°             | `name`           | String   | âœ—    | -          | ã‚«ãƒ†ã‚´ãƒªå               |
| èª¬æ˜             | `description`    | String   | âœ“    | -          | ã‚«ãƒ†ã‚´ãƒªèª¬æ˜             |
| è‰²               | `color`          | String   | âœ“    | #3B82F6    | UIè¡¨ç¤ºç”¨ã‚«ãƒ©ãƒ¼           |
| è¡¨ç¤ºé †           | `display_order`  | Int      | âœ—    | 0          | ä¸¦ã³æ›¿ãˆç”¨ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹   |
| ã‚¹ã‚³ãƒ¼ãƒ—         | `scopes`         | String[] | âœ—    | []         | åˆ©ç”¨å¯èƒ½ãªãƒšãƒ¼ã‚¸ã‚¹ã‚³ãƒ¼ãƒ— |
| æœ‰åŠ¹ãƒ•ãƒ©ã‚°       | `is_active`      | Boolean  | âœ—    | true       | åˆ©ç”¨å¯å¦                 |
| ä½œæˆæ—¥æ™‚         | `created_at`     | DateTime | âœ—    | now()      | ãƒ¬ã‚³ãƒ¼ãƒ‰ä½œæˆæ—¥æ™‚         |
| æ›´æ–°æ—¥æ™‚         | `updated_at`     | DateTime | âœ—    | -          | ãƒ¬ã‚³ãƒ¼ãƒ‰æ›´æ–°æ—¥æ™‚         |

**åˆ¶ç´„**:

- ä¸»ã‚­ãƒ¼: `id`
- ãƒ¦ãƒ‹ãƒ¼ã‚¯åˆ¶ç´„: `key`

### 10. ã‚¿ã‚°ãƒã‚¹ã‚¿ï¼ˆtagsï¼‰

**æ¦‚è¦**: ã‚«ãƒ†ã‚´ãƒªé…ä¸‹ã®å€‹åˆ¥ã‚¿ã‚°ã‚’å®šç¾©ã—ã€æ‰‹å‹•/è‡ªå‹•ä»˜ä¸å¯å¦ã‚„è¡¨ç¤ºé †ã‚’åˆ¶å¾¡

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å           | ç‰©ç†å              | ãƒ‡ãƒ¼ã‚¿å‹ | NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜                       |
| ---------------------- | ------------------- | -------- | ---- | ---------- | -------------------------- |
| ID                     | `id`                | String   | âœ—    | uuid()     | ä¸»ã‚­ãƒ¼ï¼ˆUUIDï¼‰             |
| ã‚«ãƒ†ã‚´ãƒªID             | `category_id`       | String   | âœ—    | -          | æ‰€å±ã‚«ãƒ†ã‚´ãƒªï¼ˆå¤–éƒ¨ã‚­ãƒ¼ï¼‰   |
| ã‚¿ã‚°å                 | `name`              | String   | âœ—    | -          | ã‚¿ã‚°ã®åç§°                 |
| è¡¨ç¤ºè‰²                 | `color`             | String   | âœ—    | #3B82F6    | UIè¡¨ç¤ºç”¨ã‚«ãƒ©ãƒ¼             |
| èª¬æ˜                   | `description`       | String   | âœ“    | -          | ã‚¿ã‚°ã®ç”¨é€”èª¬æ˜             |
| è¡¨ç¤ºé †                 | `display_order`     | Int      | âœ—    | 0          | ä¸¦ã³é †                     |
| æ‰‹å‹•ä»˜ä¸å¯å¦           | `allows_manual`     | Boolean  | âœ—    | true       | æ‰‹å‹•æ“ä½œã§åˆ©ç”¨å¯èƒ½ã‹       |
| è‡ªå‹•ä»˜ä¸å¯å¦           | `allows_automation` | Boolean  | âœ—    | true       | è‡ªå‹•ãƒ«ãƒ¼ãƒ«ã§åˆ©ç”¨å¯èƒ½ã‹     |
| ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿             | `metadata`          | Json     | âœ“    | -          | ä»»æ„ã®ä»˜éšæƒ…å ±             |
| æœ‰åŠ¹ãƒ•ãƒ©ã‚°             | `is_active`         | Boolean  | âœ—    | true       | åˆ©ç”¨å¯å¦                   |
| ä½œæˆæ—¥æ™‚               | `created_at`        | DateTime | âœ—    | now()      | ãƒ¬ã‚³ãƒ¼ãƒ‰ä½œæˆæ—¥æ™‚           |
| æ›´æ–°æ—¥æ™‚               | `updated_at`        | DateTime | âœ—    | -          | ãƒ¬ã‚³ãƒ¼ãƒ‰æ›´æ–°æ—¥æ™‚           |

**åˆ¶ç´„**:

- ä¸»ã‚­ãƒ¼: `id`
- è¤‡åˆãƒ¦ãƒ‹ãƒ¼ã‚¯åˆ¶ç´„: (`category_id`, `name`)
- å¤–éƒ¨ã‚­ãƒ¼: `category_id` â†’ tag_categories.idï¼ˆCASCADEï¼‰

### 11. ã‚¿ã‚°è‡ªå‹•åŒ–ãƒ«ãƒ¼ãƒ«ï¼ˆtag_automation_rulesï¼‰

**æ¦‚è¦**: ã‚¤ãƒ™ãƒ³ãƒˆã‚„ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ãƒˆãƒªã‚¬ãƒ¼ã«ã‚¿ã‚°ã‚’è‡ªå‹•ä»˜ä¸/å‰¥å¥ªã™ã‚‹ãƒ«ãƒ¼ãƒ«

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å     | ç‰©ç†å        | ãƒ‡ãƒ¼ã‚¿å‹                 | NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜                                 |
| ---------------- | ------------- | ------------------------ | ---- | ---------- | ------------------------------------ |
| ID               | `id`          | String                   | âœ—    | uuid()     | ä¸»ã‚­ãƒ¼ï¼ˆUUIDï¼‰                     |
| ã‚­ãƒ¼             | `key`         | String                   | âœ—    | -          | ãƒ«ãƒ¼ãƒ«è­˜åˆ¥å­ï¼ˆãƒ¦ãƒ‹ãƒ¼ã‚¯ï¼‰           |
| åç§°             | `name`        | String                   | âœ—    | -          | ãƒ«ãƒ¼ãƒ«å                             |
| èª¬æ˜             | `description` | String                   | âœ“    | -          | ãƒ«ãƒ¼ãƒ«ã®èª¬æ˜                         |
| ãƒˆãƒªã‚¬ç¨®åˆ¥       | `trigger_type`| TagAutomationTriggerType | âœ—    | -          | EVENT / SCHEDULE / MANUAL           |
| ã‚¤ãƒ™ãƒ³ãƒˆç¨®åˆ¥     | `event_type`  | TagAutomationEventType   | âœ—    | -          | å…·ä½“çš„ãªãƒˆãƒªã‚¬ã‚¤ãƒ™ãƒ³ãƒˆ               |
| ã‚¹ã‚³ãƒ¼ãƒ—         | `scope`       | String                   | âœ“    | -          | é©ç”¨å¯¾è±¡ã‚¹ã‚³ãƒ¼ãƒ—                     |
| æœ‰åŠ¹ãƒ•ãƒ©ã‚°       | `is_active`   | Boolean                  | âœ—    | true       | ãƒ«ãƒ¼ãƒ«ãŒæœ‰åŠ¹ã‹                       |
| å„ªå…ˆåº¦           | `priority`    | Int                      | âœ—    | 0          | ãƒ«ãƒ¼ãƒ«é©ç”¨å„ªå…ˆåº¦                     |
| ã‚³ãƒ³ãƒ•ã‚£ã‚°       | `config`      | Json                     | âœ“    | -          | è¿½åŠ è¨­å®šï¼ˆJSONï¼‰                     |
| ä½œæˆæ—¥æ™‚         | `created_at`  | DateTime                 | âœ—    | now()      | ä½œæˆæ—¥æ™‚                             |
| æ›´æ–°æ—¥æ™‚         | `updated_at`  | DateTime                 | âœ—    | -          | æ›´æ–°æ—¥æ™‚                             |

**åˆ¶ç´„**:

- ä¸»ã‚­ãƒ¼: `id`
- ãƒ¦ãƒ‹ãƒ¼ã‚¯åˆ¶ç´„: `key`

### 12. ã‚¿ã‚°è‡ªå‹•åŒ–å®Ÿè¡Œï¼ˆtag_automation_runsï¼‰

**æ¦‚è¦**: è‡ªå‹•åŒ–ãƒ«ãƒ¼ãƒ«ã®å®Ÿè¡Œå±¥æ­´ã¨å‡¦ç†çµæœã‚’ä¿å­˜

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å       | ç‰©ç†å          | ãƒ‡ãƒ¼ã‚¿å‹               | NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜                     |
| ------------------ | --------------- | ---------------------- | ---- | ---------- | ------------------------ |
| ID                 | `id`            | String                 | âœ—    | uuid()     | ä¸»ã‚­ãƒ¼ï¼ˆUUIDï¼‰           |
| ãƒ«ãƒ¼ãƒ«ID           | `rule_id`       | String                 | âœ—    | -          | é–¢é€£ãƒ«ãƒ¼ãƒ«ï¼ˆå¤–éƒ¨ã‚­ãƒ¼ï¼‰   |
| ã‚¤ãƒ™ãƒ³ãƒˆãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ | `event_payload` | Json                   | âœ“    | -          | å®Ÿè¡Œæ™‚ã®å…¥åŠ›ãƒ‡ãƒ¼ã‚¿       |
| ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹         | `status`        | TagAutomationRunStatus | âœ—    | PENDING    | å®Ÿè¡ŒçŠ¶æ…‹                 |
| é–‹å§‹æ™‚åˆ»           | `started_at`    | DateTime               | âœ“    | -          | é–‹å§‹æ™‚é–“                 |
| å®Œäº†æ™‚åˆ»           | `completed_at`  | DateTime               | âœ“    | -          | å®Œäº†æ™‚é–“                 |
| ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸   | `error_message` | String                 | âœ“    | -          | å¤±æ•—æ™‚ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸         |
| ä½œæˆæ—¥æ™‚           | `created_at`    | DateTime               | âœ—    | now()      | ãƒ¬ã‚³ãƒ¼ãƒ‰ä½œæˆæ—¥æ™‚         |
| æ›´æ–°æ—¥æ™‚           | `updated_at`    | DateTime               | âœ—    | -          | ãƒ¬ã‚³ãƒ¼ãƒ‰æ›´æ–°æ—¥æ™‚         |

**åˆ¶ç´„**:

- ä¸»ã‚­ãƒ¼: `id`
- å¤–éƒ¨ã‚­ãƒ¼: `rule_id` â†’ tag_automation_rules.idï¼ˆCASCADEï¼‰
- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹: `rule_id`

### 13. ã‚¿ã‚°ä»˜ä¸å±¥æ­´ï¼ˆtag_assignment_historyï¼‰

**æ¦‚è¦**: æ‰‹å‹•/è‡ªå‹•ã‚’å•ã‚ãšã‚¿ã‚°ä»˜ä¸ãƒ»å‰¥å¥ªæ“ä½œã®å±¥æ­´ã‚’ä¿ç®¡

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å | ç‰©ç†å              | ãƒ‡ãƒ¼ã‚¿å‹             | NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜                           |
| ------------ | ------------------- | -------------------- | ---- | ---------- | ------------------------------ |
| ID           | `id`                | String               | âœ—    | uuid()     | ä¸»ã‚­ãƒ¼ï¼ˆUUIDï¼‰                 |
| çŒ«ID         | `cat_id`            | String               | âœ—    | -          | å¯¾è±¡çŒ«ï¼ˆå¤–éƒ¨ã‚­ãƒ¼ï¼‰             |
| ã‚¿ã‚°ID       | `tag_id`            | String               | âœ—    | -          | å¯¾è±¡ã‚¿ã‚°ï¼ˆå¤–éƒ¨ã‚­ãƒ¼ï¼‰           |
| ãƒ«ãƒ¼ãƒ«ID     | `rule_id`           | String               | âœ“    | -          | è‡ªå‹•åŒ–ãƒ«ãƒ¼ãƒ«ï¼ˆä»»æ„ï¼‰           |
| å®Ÿè¡ŒID       | `automation_run_id` | String               | âœ“    | -          | è‡ªå‹•åŒ–å®Ÿè¡Œå±¥æ­´ï¼ˆä»»æ„ï¼‰         |
| ã‚¢ã‚¯ã‚·ãƒ§ãƒ³   | `action`            | TagAssignmentAction  | âœ—    | ASSIGNED   | ASSIGNED / UNASSIGNED         |
| ã‚½ãƒ¼ã‚¹       | `source`            | TagAssignmentSource  | âœ—    | MANUAL     | MANUAL / AUTOMATION / SYSTEM |
| ç†ç”±         | `reason`            | String               | âœ“    | -          | æ“ä½œç†ç”±                       |
| ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿   | `metadata`          | Json                 | âœ“    | -          | è¿½åŠ æƒ…å ±                       |
| ä½œæˆæ—¥æ™‚     | `created_at`        | DateTime             | âœ—    | now()      | ãƒ¬ã‚³ãƒ¼ãƒ‰ä½œæˆæ—¥æ™‚               |

**åˆ¶ç´„**:

- ä¸»ã‚­ãƒ¼: `id`
- å¤–éƒ¨ã‚­ãƒ¼: `cat_id` â†’ cats.idï¼ˆCASCADEï¼‰
- å¤–éƒ¨ã‚­ãƒ¼: `tag_id` â†’ tags.idï¼ˆCASCADEï¼‰
- å¤–éƒ¨ã‚­ãƒ¼: `rule_id` â†’ tag_automation_rules.idï¼ˆSET NULLï¼‰
- å¤–éƒ¨ã‚­ãƒ¼: `automation_run_id` â†’ tag_automation_runs.idï¼ˆSET NULLï¼‰
- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹: `cat_id`, `tag_id`, `rule_id`, `automation_run_id`
### 14. è¡€çµ±æƒ…å ±ï¼ˆpedigreesï¼‰

**æ¦‚è¦**: è¡€çµ±æ›¸ãƒ‡ãƒ¼ã‚¿ã¨å®¶ç³»å›³æƒ…å ±ã‚’ç®¡ç†ã™ã‚‹è¤‡é›‘ãªãƒ†ãƒ¼ãƒ–ãƒ«

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å | ç‰©ç†å                | ãƒ‡ãƒ¼ã‚¿å‹ | NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜                   |
| ------------ | --------------------- | -------- | ---- | ---------- | ---------------------- |
| ID           | `id`                  | String   | âœ—    | uuid()     | ä¸»ã‚­ãƒ¼ï¼ˆUUIDï¼‰         |
| è¡€çµ±æ›¸ID     | `pedigree_id`         | String   | âœ—    | -          | è¡€çµ±æ›¸ã®è­˜åˆ¥ç•ªå·       |
| çŒ«ID         | `cat_id`              | String   | âœ“    | -          | å¯¾è±¡çŒ«ï¼ˆå¤–éƒ¨ã‚­ãƒ¼ï¼‰     |
| ã‚¿ã‚¤ãƒˆãƒ«     | `title`               | String   | âœ“    | -          | ç§°å·ãƒ»ã‚¿ã‚¤ãƒˆãƒ«         |
| çŒ«å         | `cat_name`            | String   | âœ—    | -          | è¡€çµ±æ›¸è¨˜è¼‰å           |
| çŒ«å2        | `cat_name2`           | String   | âœ“    | -          | åˆ¥åãƒ»é€šç§°             |
| çŒ«ç¨®ID       | `breed_id`            | String   | âœ“    | -          | å“ç¨®ï¼ˆå¤–éƒ¨ã‚­ãƒ¼ï¼‰       |
| çŒ«ç¨®ã‚³ãƒ¼ãƒ‰   | `breed_code`          | Int      | âœ“    | -          | å“ç¨®ã®æ•°å€¤ã‚³ãƒ¼ãƒ‰       |
| æ€§åˆ¥         | `gender`              | Int      | âœ“    | -          | æ€§åˆ¥ï¼ˆ1=ã‚ªã‚¹ã€2=ãƒ¡ã‚¹ï¼‰ |
| ç›®è‰²         | `eye_color`           | String   | âœ“    | -          | ç›®ã®è‰²                 |
| æ¯›è‰²ID       | `color_id`            | String   | âœ“    | -          | æ¯›è‰²ï¼ˆå¤–éƒ¨ã‚­ãƒ¼ï¼‰       |
| æ¯›è‰²ã‚³ãƒ¼ãƒ‰   | `coat_color_code`     | Int      | âœ“    | -          | æ¯›è‰²ã®æ•°å€¤ã‚³ãƒ¼ãƒ‰       |
| ç”Ÿå¹´æœˆæ—¥     | `birth_date`          | DateTime | âœ“    | -          | èª•ç”Ÿæ—¥                 |
| ç™»éŒ²æ—¥       | `registration_date`   | DateTime | âœ“    | -          | è¡€çµ±æ›¸ç™»éŒ²æ—¥           |
| ç™ºè¡Œæ—¥       | `pedigree_issue_date` | DateTime | âœ“    | -          | è¡€çµ±æ›¸ç™ºè¡Œæ—¥           |
| ç¹æ®–è€…å     | `breeder_name`        | String   | âœ“    | -          | ãƒ–ãƒªãƒ¼ãƒ€ãƒ¼å           |
| æ‰€æœ‰è€…å     | `owner_name`          | String   | âœ“    | -          | æ‰€æœ‰è€…å               |
| å…„å¼Ÿæ•°       | `brother_count`       | Int      | âœ“    | -          | å…„å¼Ÿã®æ•°               |
| å§‰å¦¹æ•°       | `sister_count`        | Int      | âœ“    | -          | å§‰å¦¹ã®æ•°               |
| å‚™è€ƒ         | `notes`               | String   | âœ“    | -          | æ‘˜è¦                   |
| å‚™è€ƒ2        | `notes2`              | String   | âœ“    | -          | æ‘˜è¦2                  |
| ä»–å›£ä½“ç•ªå·   | `other_no`            | String   | âœ“    | -          | ä»–ã®ç™»éŒ²å›£ä½“ç•ªå·       |
| æ—§ã‚³ãƒ¼ãƒ‰     | `old_code`            | String   | âœ“    | -          | æ—§ã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒ¼ãƒ‰       |
| ä½œæˆæ—¥æ™‚     | `created_at`          | DateTime | âœ—    | now()      | ãƒ¬ã‚³ãƒ¼ãƒ‰ä½œæˆæ—¥æ™‚       |
| æ›´æ–°æ—¥æ™‚     | `updated_at`          | DateTime | âœ—    | -          | ãƒ¬ã‚³ãƒ¼ãƒ‰æ›´æ–°æ—¥æ™‚       |

**è¡€çµ±é–¢ä¿‚ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰**:

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å | ç‰©ç†å                    | ãƒ‡ãƒ¼ã‚¿å‹ | NULL | èª¬æ˜           |
| ------------ | ------------------------- | -------- | ---- | -------------- |
| çˆ¶è¡€çµ±ID     | `father_pedigree_id`      | String   | âœ“    | çˆ¶è¦ªã®è¡€çµ±è¨˜éŒ² |
| æ¯è¡€çµ±ID     | `mother_pedigree_id`      | String   | âœ“    | æ¯è¦ªã®è¡€çµ±è¨˜éŒ² |
| çˆ¶æ–¹ç¥–çˆ¶ID   | `paternal_grandfather_id` | String   | âœ“    | çˆ¶æ–¹ã®ç¥–çˆ¶     |
| çˆ¶æ–¹ç¥–æ¯ID   | `paternal_grandmother_id` | String   | âœ“    | çˆ¶æ–¹ã®ç¥–æ¯     |
| æ¯æ–¹ç¥–çˆ¶ID   | `maternal_grandfather_id` | String   | âœ“    | æ¯æ–¹ã®ç¥–çˆ¶     |
| æ¯æ–¹ç¥–æ¯ID   | `maternal_grandmother_id` | String   | âœ“    | æ¯æ–¹ã®ç¥–æ¯     |

**åˆ¶ç´„**:

- ä¸»ã‚­ãƒ¼: `id`
- ãƒ¦ãƒ‹ãƒ¼ã‚¯åˆ¶ç´„: `pedigree_id`
- å¤–éƒ¨ã‚­ãƒ¼: `cat_id` â†’ cats.id
- å¤–éƒ¨ã‚­ãƒ¼: `breed_id` â†’ breeds.id, `color_id` â†’ coat_colors.id
- è‡ªå·±å‚ç…§å¤–éƒ¨ã‚­ãƒ¼: å„è¡€çµ±é–¢ä¿‚ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ â†’ pedigrees.id

**è‡ªå·±å‚ç…§ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³**:

- â†’ fatherPedigreeï¼ˆå¤šå¯¾1ï¼‰: çˆ¶è¦ªè¡€çµ±
- â†’ motherPedigreeï¼ˆå¤šå¯¾1ï¼‰: æ¯è¦ªè¡€çµ±
- â†’ paternalGrandfatherï¼ˆå¤šå¯¾1ï¼‰: çˆ¶æ–¹ç¥–çˆ¶
- â†’ paternalGrandmotherï¼ˆå¤šå¯¾1ï¼‰: çˆ¶æ–¹ç¥–æ¯
- â†’ maternalGrandfatherï¼ˆå¤šå¯¾1ï¼‰: æ¯æ–¹ç¥–çˆ¶
- â†’ maternalGrandmotherï¼ˆå¤šå¯¾1ï¼‰: æ¯æ–¹ç¥–æ¯
- â†’ fatherOfï¼ˆ1å¯¾å¤šï¼‰: çˆ¶è¦ªã¨ã—ã¦ã®å­å­«


### 15. çŒ«ã‚¿ã‚°é–¢é€£ï¼ˆcat_tagsï¼‰

**æ¦‚è¦**: çŒ«ã¨ã‚¿ã‚°ã®å¤šå¯¾å¤šé–¢ä¿‚ã‚’ç®¡ç†ã™ã‚‹ä¸­é–“ãƒ†ãƒ¼ãƒ–ãƒ«

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å | ç‰©ç†å       | ãƒ‡ãƒ¼ã‚¿å‹ | NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜                 |
| ------------ | ------------ | -------- | ---- | ---------- | -------------------- |
| çŒ«ID         | `cat_id`     | String   | âœ—    | -          | å¯¾è±¡çŒ«ï¼ˆå¤–éƒ¨ã‚­ãƒ¼ï¼‰   |
| ã‚¿ã‚°ID       | `tag_id`     | String   | âœ—    | -          | å¯¾è±¡ã‚¿ã‚°ï¼ˆå¤–éƒ¨ã‚­ãƒ¼ï¼‰ |
| ä½œæˆæ—¥æ™‚     | `created_at` | DateTime | âœ—    | now()      | é–¢é€£ä½œæˆæ—¥æ™‚         |

**åˆ¶ç´„**:

- è¤‡åˆä¸»ã‚­ãƒ¼: `(cat_id, tag_id)`
- å¤–éƒ¨ã‚­ãƒ¼: `cat_id` â†’ cats.idï¼ˆCASCADEå‰Šé™¤ï¼‰
- å¤–éƒ¨ã‚­ãƒ¼: `tag_id` â†’ tags.idï¼ˆCASCADEå‰Šé™¤ï¼‰

---

## ğŸ”— ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¨­è¨ˆè©³ç´°

### ä¸»è¦ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å›³

```
users (1) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ (âˆ) cats
  â”‚                      â”‚
  â”‚                      â”œâ”€â”€ (âˆ) breeding_records
  â”‚                      â”œâ”€â”€ (âˆ) care_records
  â”‚                      â”œâ”€â”€ (âˆ) schedules
  â”‚                      â”œâ”€â”€ (âˆ) pedigrees
  â”‚                      â””â”€â”€ (âˆ) cat_tags (âˆ) â”€â”€â†’ (1) tags
  â”‚
  â”œâ”€â”€ (âˆ) breeding_records
  â”œâ”€â”€ (âˆ) care_records
  â”œâ”€â”€ (âˆ) schedules
  â””â”€â”€ (âˆ) login_attempts

breeds (1) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ (âˆ) cats
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ (âˆ) pedigrees

coat_colors (1) â”€â”€â”€â”€â”€â†’ (âˆ) cats
               â””â”€â”€â”€â”€â”€â†’ (âˆ) pedigrees

cats (1) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ (âˆ) cats (è‡ªå·±å‚ç…§: è¦ªå­é–¢ä¿‚)

pedigrees (1) â”€â”€â”€â”€â”€â”€â”€â†’ (âˆ) pedigrees (è‡ªå·±å‚ç…§: è¡€çµ±é–¢ä¿‚)
```

### 1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸­å¿ƒã®ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

**users â†’ catsï¼ˆ1å¯¾å¤šï¼‰**

- é–¢ä¿‚: ä¸€äººã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¤‡æ•°ã®çŒ«ã‚’æ‰€æœ‰
- å¤–éƒ¨ã‚­ãƒ¼: cats.owner_id â†’ users.id
- å‰Šé™¤åˆ¶ç´„: RESTRICTï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼å‰Šé™¤æ™‚ã¯çŒ«ã®æ‰€æœ‰æ¨©ç§»è»¢ãŒå¿…è¦ï¼‰

**users â†’ breeding_recordsï¼ˆ1å¯¾å¤šï¼‰**

- é–¢ä¿‚: ä¸€äººã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¤‡æ•°ã®äº¤é…è¨˜éŒ²ã‚’ä½œæˆ
- å¤–éƒ¨ã‚­ãƒ¼: breeding_records.recorded_by â†’ users.id
- å‰Šé™¤åˆ¶ç´„: RESTRICTï¼ˆè¨˜éŒ²ã®æ•´åˆæ€§ä¿æŒï¼‰

**users â†’ care_recordsï¼ˆ1å¯¾å¤šï¼‰**

- é–¢ä¿‚: ä¸€äººã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¤‡æ•°ã®ã‚±ã‚¢è¨˜éŒ²ã‚’ä½œæˆ
- å¤–éƒ¨ã‚­ãƒ¼: care_records.recorded_by â†’ users.id
- å‰Šé™¤åˆ¶ç´„: RESTRICTï¼ˆè¨˜éŒ²ã®æ•´åˆæ€§ä¿æŒï¼‰

**users â†’ schedulesï¼ˆ1å¯¾å¤šï¼‰**

- é–¢ä¿‚: ä¸€äººã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¤‡æ•°ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’æ‹…å½“
- å¤–éƒ¨ã‚­ãƒ¼: schedules.assigned_to â†’ users.id
- å‰Šé™¤åˆ¶ç´„: RESTRICTï¼ˆã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã®å†å‰²ã‚Šå½“ã¦ãŒå¿…è¦ï¼‰

**users â†’ login_attemptsï¼ˆ1å¯¾å¤šï¼‰**

- é–¢ä¿‚: ä¸€äººã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¤‡æ•°ã®ãƒ­ã‚°ã‚¤ãƒ³è©¦è¡Œå±¥æ­´ã‚’æŒã¤
- å¤–éƒ¨ã‚­ãƒ¼: login_attempts.user_id â†’ users.id
- å‰Šé™¤åˆ¶ç´„: CASCADEï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼å‰Šé™¤æ™‚ã«å±¥æ­´ã‚‚å‰Šé™¤ï¼‰

### 2. çŒ«ä¸­å¿ƒã®ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

**cats â†’ catsï¼ˆè‡ªå·±å‚ç…§ã€è¦ªå­é–¢ä¿‚ï¼‰**

- fatheré–¢ä¿‚: cats.father_id â†’ cats.idï¼ˆå¤šå¯¾1ï¼‰
- motheré–¢ä¿‚: cats.mother_id â†’ cats.idï¼ˆå¤šå¯¾1ï¼‰
- fatherOfé–¢ä¿‚: 1å¯¾å¤šï¼ˆé€†æ–¹å‘ï¼‰
- motherOfé–¢ä¿‚: 1å¯¾å¤šï¼ˆé€†æ–¹å‘ï¼‰
- å‰Šé™¤åˆ¶ç´„: SET NULLï¼ˆè¦ªãŒå‰Šé™¤ã•ã‚Œã¦ã‚‚å­ã¯æ®‹ã‚‹ï¼‰

**breeds â†’ catsï¼ˆ1å¯¾å¤šï¼‰**

- é–¢ä¿‚: ä¸€ã¤ã®å“ç¨®ã«è¤‡æ•°ã®çŒ«ãŒå±ã™ã‚‹
- å¤–éƒ¨ã‚­ãƒ¼: cats.breed_id â†’ breeds.id
- å‰Šé™¤åˆ¶ç´„: SET NULLï¼ˆå“ç¨®å‰Šé™¤æ™‚ã¯NULLã«è¨­å®šï¼‰

**coat_colors â†’ catsï¼ˆ1å¯¾å¤šï¼‰**

- é–¢ä¿‚: ä¸€ã¤ã®æ¯›è‰²ã«è¤‡æ•°ã®çŒ«ãŒå±ã™ã‚‹
- å¤–éƒ¨ã‚­ãƒ¼: cats.color_id â†’ coat_colors.id
- å‰Šé™¤åˆ¶ç´„: SET NULLï¼ˆæ¯›è‰²å‰Šé™¤æ™‚ã¯NULLã«è¨­å®šï¼‰

**cats â†’ breeding_recordsï¼ˆ1å¯¾å¤šã€åŒæ–¹å‘ï¼‰**

- maleé–¢ä¿‚: breeding_records.male_id â†’ cats.id
- femaleé–¢ä¿‚: breeding_records.female_id â†’ cats.id
- å‰Šé™¤åˆ¶ç´„: RESTRICTï¼ˆäº¤é…è¨˜éŒ²ãŒã‚ã‚‹çŒ«ã¯å‰Šé™¤ä¸å¯ï¼‰

**cats â†’ care_recordsï¼ˆ1å¯¾å¤šï¼‰**

- é–¢ä¿‚: ä¸€åŒ¹ã®çŒ«ãŒè¤‡æ•°ã®ã‚±ã‚¢è¨˜éŒ²ã‚’æŒã¤
- å¤–éƒ¨ã‚­ãƒ¼: care_records.cat_id â†’ cats.id
- å‰Šé™¤åˆ¶ç´„: CASCADEï¼ˆçŒ«å‰Šé™¤æ™‚ã«ã‚±ã‚¢è¨˜éŒ²ã‚‚å‰Šé™¤ï¼‰

**cats â†’ schedulesï¼ˆ1å¯¾å¤šï¼‰**

- é–¢ä¿‚: ä¸€åŒ¹ã®çŒ«ãŒè¤‡æ•°ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’æŒã¤
- å¤–éƒ¨ã‚­ãƒ¼: schedules.cat_id â†’ cats.id
- å‰Šé™¤åˆ¶ç´„: SET NULLï¼ˆçŒ«å‰Šé™¤æ™‚ã¯ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯æ±ç”¨ã«å¤‰æ›´ï¼‰

**cats â†’ pedigreesï¼ˆ1å¯¾å¤šï¼‰**

- é–¢ä¿‚: ä¸€åŒ¹ã®çŒ«ãŒè¤‡æ•°ã®è¡€çµ±è¨˜éŒ²ã‚’æŒã¤ï¼ˆç¨€ï¼‰
- å¤–éƒ¨ã‚­ãƒ¼: pedigrees.cat_id â†’ cats.id
- å‰Šé™¤åˆ¶ç´„: SET NULLï¼ˆçŒ«å‰Šé™¤æ™‚ã‚‚è¡€çµ±è¨˜éŒ²ã¯ä¿æŒï¼‰

### 3. è¡€çµ±é–¢ä¿‚ã®ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

**pedigrees â†’ pedigreesï¼ˆè‡ªå·±å‚ç…§ã€è¡€çµ±é–¢ä¿‚ï¼‰**

**ç›´ç³»è¡€çµ±é–¢ä¿‚**:

- fatherPedigree: pedigrees.father_pedigree_id â†’ pedigrees.id
- motherPedigree: pedigrees.mother_pedigree_id â†’ pedigrees.id
- fatherOf: 1å¯¾å¤šï¼ˆé€†æ–¹å‘ï¼‰
- motherOf: 1å¯¾å¤šï¼ˆé€†æ–¹å‘ï¼‰

**ç¥–çˆ¶æ¯é–¢ä¿‚**:

- paternalGrandfather: pedigrees.paternal_grandfather_id â†’ pedigrees.id
- paternalGrandmother: pedigrees.paternal_grandmother_id â†’ pedigrees.id
- maternalGrandfather: pedigrees.maternal_grandfather_id â†’ pedigrees.id
- maternalGrandmother: pedigrees.maternal_grandmother_id â†’ pedigrees.id
- å„ç¥–çˆ¶æ¯ã‹ã‚‰ã®é€†æ–¹å‘1å¯¾å¤šé–¢ä¿‚

**å‰Šé™¤åˆ¶ç´„**: SET NULLï¼ˆè¡€çµ±è¨˜éŒ²å‰Šé™¤æ™‚ã‚‚é–¢ä¿‚æ€§ã¯ä¿æŒï¼‰

**breeds â†’ pedigreesï¼ˆ1å¯¾å¤šï¼‰**

- é–¢ä¿‚: ä¸€ã¤ã®å“ç¨®ã«è¤‡æ•°ã®è¡€çµ±è¨˜éŒ²
- å¤–éƒ¨ã‚­ãƒ¼: pedigrees.breed_id â†’ breeds.id
- å‰Šé™¤åˆ¶ç´„: SET NULL

**coat_colors â†’ pedigreesï¼ˆ1å¯¾å¤šï¼‰**

- é–¢ä¿‚: ä¸€ã¤ã®æ¯›è‰²ã«è¤‡æ•°ã®è¡€çµ±è¨˜éŒ²
- å¤–éƒ¨ã‚­ãƒ¼: pedigrees.color_id â†’ coat_colors.id
- å‰Šé™¤åˆ¶ç´„: SET NULL

### 4. ã‚¿ã‚°é–¢ä¿‚ã®ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

**cats â†” tagsï¼ˆå¤šå¯¾å¤šã€cat_tagsçµŒç”±ï¼‰**

- ä¸­é–“ãƒ†ãƒ¼ãƒ–ãƒ«: cat_tags
- é–¢ä¿‚1: cat_tags.cat_id â†’ cats.id
- é–¢ä¿‚2: cat_tags.tag_id â†’ tags.id
- å‰Šé™¤åˆ¶ç´„: CASCADEï¼ˆçŒ«ã¾ãŸã¯ã‚¿ã‚°å‰Šé™¤æ™‚ã«é–¢é€£ã‚‚å‰Šé™¤ï¼‰

---

## ğŸ“‹ åˆ—æŒ™å‹ï¼ˆEnumï¼‰å®šç¾©

### 1. UserRoleï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ãƒ¼ãƒ«ï¼‰

```
USER         - ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼
ADMIN        - ç®¡ç†è€…
SUPER_ADMIN  - ã‚¹ãƒ¼ãƒ‘ãƒ¼ç®¡ç†è€…
```

### 2. Genderï¼ˆæ€§åˆ¥ï¼‰

```
MALE    - ã‚ªã‚¹
FEMALE  - ãƒ¡ã‚¹
```

### 3. BreedingStatusï¼ˆäº¤é…ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼‰

```
PLANNED      - è¨ˆç”»ä¸­
IN_PROGRESS  - é€²è¡Œä¸­
COMPLETED    - å®Œäº†
FAILED       - å¤±æ•—
```

### 4. CareTypeï¼ˆã‚±ã‚¢ç¨®åˆ¥ï¼‰

```
VACCINATION   - äºˆé˜²æ¥ç¨®
HEALTH_CHECK  - å¥åº·è¨ºæ–­
GROOMING      - ã‚°ãƒ«ãƒ¼ãƒŸãƒ³ã‚°
DENTAL_CARE   - æ­¯ç§‘ã‚±ã‚¢
MEDICATION    - æŠ•è–¬
SURGERY       - æ‰‹è¡“
OTHER         - ãã®ä»–
```

### 5. ScheduleTypeï¼ˆã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç¨®åˆ¥ï¼‰

```
BREEDING     - ç¹æ®–é–¢é€£
CARE         - ã‚±ã‚¢é–¢é€£
APPOINTMENT  - è¨ºå¯Ÿäºˆç´„
REMINDER     - ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼
MAINTENANCE  - ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹
```

### 6. ScheduleStatusï¼ˆã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼‰

```
PENDING      - æœªå®Ÿè¡Œ
IN_PROGRESS  - å®Ÿè¡Œä¸­
COMPLETED    - å®Œäº†
CANCELLED    - ã‚­ãƒ£ãƒ³ã‚»ãƒ«
```

### 7. Priorityï¼ˆå„ªå…ˆåº¦ï¼‰

```
LOW     - ä½
MEDIUM  - ä¸­
HIGH    - é«˜
URGENT  - ç·Šæ€¥
```

---

## ğŸ”’ åˆ¶ç´„ã¨ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹

### ä¸»è¦åˆ¶ç´„ä¸€è¦§

**ä¸€æ„åˆ¶ç´„ï¼ˆUNIQUEï¼‰**:

- users.clerk_id
- users.email
- breeds.code, breeds.name
- coat_colors.code, coat_colors.name
- cats.registration_id
- cats.microchip_id
- tags.name
- pedigrees.pedigree_id

**å¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„ï¼ˆFOREIGN KEYï¼‰**:

- å…¨ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã«é©ç”¨
- å‰Šé™¤æ™‚ã®å‹•ä½œã¯é–¢ä¿‚æ€§ã«ã‚ˆã‚Šè¨­å®š

**éNULLåˆ¶ç´„ï¼ˆNOT NULLï¼‰**:

- å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«é©ç”¨
- ä¸»ã‚­ãƒ¼ã€å¿…é ˆã®æ¥­å‹™ãƒ‡ãƒ¼ã‚¿

### æ¨å¥¨ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹

**ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Šã®ãŸã‚ä»¥ä¸‹ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’æ¨å¥¨**:

```sql
-- ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¤œç´¢ç”¨
CREATE INDEX idx_users_email ON users(email);
CREATE INDEX idx_users_role ON users(role);

-- çŒ«æ¤œç´¢ç”¨
CREATE INDEX idx_cats_owner_id ON cats(owner_id);
CREATE INDEX idx_cats_breed_id ON cats(breed_id);
CREATE INDEX idx_cats_color_id ON cats(color_id);
CREATE INDEX idx_cats_birth_date ON cats(birth_date);
CREATE INDEX idx_cats_gender ON cats(gender);

-- è¡€çµ±æ¤œç´¢ç”¨
CREATE INDEX idx_pedigrees_cat_id ON pedigrees(cat_id);
CREATE INDEX idx_pedigrees_father_pedigree_id ON pedigrees(father_pedigree_id);
CREATE INDEX idx_pedigrees_mother_pedigree_id ON pedigrees(mother_pedigree_id);

-- è¨˜éŒ²æ¤œç´¢ç”¨
CREATE INDEX idx_breeding_records_male_id ON breeding_records(male_id);
CREATE INDEX idx_breeding_records_female_id ON breeding_records(female_id);
CREATE INDEX idx_breeding_records_breeding_date ON breeding_records(breeding_date);

CREATE INDEX idx_care_records_cat_id ON care_records(cat_id);
CREATE INDEX idx_care_records_care_date ON care_records(care_date);
CREATE INDEX idx_care_records_care_type ON care_records(care_type);

CREATE INDEX idx_schedules_cat_id ON schedules(cat_id);
CREATE INDEX idx_schedules_assigned_to ON schedules(assigned_to);
CREATE INDEX idx_schedules_schedule_date ON schedules(schedule_date);
CREATE INDEX idx_schedules_status ON schedules(status);
```

---

## ğŸš€ æœ¬ç•ªç’°å¢ƒãƒ‡ãƒ—ãƒ­ã‚¤æ™‚ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­å®š

### 1. ç’°å¢ƒå¤‰æ•°è¨­å®š

```bash
# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶š
DATABASE_URL="postgresql://username:password@localhost:5432/mycats_production"

# Prismaè¨­å®š
PRISMA_QUERY_ENGINE_LIBRARY="true"
```

### 2. ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †

```bash
# 1. ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pnpm install --frozen-lockfile

# 2. Prismaã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆç”Ÿæˆ
pnpm -w run db:generate

# 3. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
pnpm -w run db:deploy

# 4. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ“ãƒ«ãƒ‰
pnpm run build

# 5. æœ¬ç•ªã‚µãƒ¼ãƒãƒ¼èµ·å‹•
NODE_ENV=production node backend/dist/main.js
```

### 3. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åˆæœŸåŒ–

**æœ¬ç•ªç’°å¢ƒã§ã¯ä»¥ä¸‹ã®åˆæœŸãƒ‡ãƒ¼ã‚¿ãŒå¿…è¦**:

1. **ç®¡ç†è€…ãƒ¦ãƒ¼ã‚¶ãƒ¼**: ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†ç”¨
2. **åŸºæœ¬å“ç¨®ãƒ‡ãƒ¼ã‚¿**: breeds ãƒ†ãƒ¼ãƒ–ãƒ«
3. **åŸºæœ¬æ¯›è‰²ãƒ‡ãƒ¼ã‚¿**: coat_colors ãƒ†ãƒ¼ãƒ–ãƒ«
4. **åŸºæœ¬ã‚¿ã‚°**: tags ãƒ†ãƒ¼ãƒ–ãƒ«

### 4. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æˆ¦ç•¥

**æ¨å¥¨ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è¨­å®š**:

- **å®šæœŸãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—**: æ—¥æ¬¡è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
- **å·®åˆ†ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—**: æ™‚é–“å˜ä½ã®å·®åˆ†ä¿å­˜
- **ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³**: èª­ã¿å–ã‚Šå°‚ç”¨ãƒ¬ãƒ—ãƒªã‚«ã®è¨­å®š
- **ãƒã‚¤ãƒ³ãƒˆã‚¤ãƒ³ã‚¿ã‚¤ãƒ ãƒªã‚«ãƒãƒª**: WALãƒ­ã‚°ã®ä¿æŒ

---

## ğŸ“ˆ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è€ƒæ…®äº‹é …

### 1. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆä¸Šã®æœ€é©åŒ–

**æ­£è¦åŒ–ãƒ¬ãƒ™ãƒ«**: ç¬¬3æ­£è¦å½¢ã¾ã§é©ç”¨
**éæ­£è¦åŒ–ç®‡æ‰€**: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹é‡è¦–ç®‡æ‰€ã§ã®æ„å›³çš„ãªéæ­£è¦åŒ–
**ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–æˆ¦ç•¥**: å¤ã„ãƒ‡ãƒ¼ã‚¿ã®åˆ¥ãƒ†ãƒ¼ãƒ–ãƒ«ç§»è¡Œ

### 2. ã‚¯ã‚¨ãƒªæœ€é©åŒ–

**é »ç¹ãªã‚¯ã‚¨ãƒªãƒ‘ã‚¿ãƒ¼ãƒ³**:

- æ‰€æœ‰è€…åˆ¥çŒ«ä¸€è¦§
- çŒ«ã®è¡€çµ±æ¤œç´¢
- æœŸé–“åˆ¥ã‚±ã‚¢è¨˜éŒ²
- äºˆå®šæ¸ˆã¿ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«

**æœ€é©åŒ–ã•ã‚ŒãŸã‚¯ã‚¨ãƒªä¾‹**:

```sql
-- æ‰€æœ‰è€…ã®çŒ«ä¸€è¦§ï¼ˆé–¢é€£ãƒ‡ãƒ¼ã‚¿å«ã‚€ï¼‰
SELECT c.*, b.name as breed_name, cc.name as color_name
FROM cats c
LEFT JOIN breeds b ON c.breed_id = b.id
LEFT JOIN coat_colors cc ON c.color_id = cc.id
WHERE c.owner_id = $1 AND c.is_active = true
ORDER BY c.birth_date DESC;

-- è¡€çµ±3ä¸–ä»£æ¤œç´¢
WITH RECURSIVE pedigree_tree AS (
  SELECT id, cat_name, father_pedigree_id, mother_pedigree_id, 0 as generation
  FROM pedigrees WHERE id = $1
  UNION ALL
  SELECT p.id, p.cat_name, p.father_pedigree_id, p.mother_pedigree_id, pt.generation + 1
  FROM pedigrees p
  JOIN pedigree_tree pt ON (p.id = pt.father_pedigree_id OR p.id = pt.mother_pedigree_id)
  WHERE pt.generation < 3
)
SELECT * FROM pedigree_tree;
```

---

## ğŸ” ç›£è¦–ã¨ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹

### 1. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç›£è¦–é …ç›®

**ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–**:

- ã‚¯ã‚¨ãƒªå®Ÿè¡Œæ™‚é–“
- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä½¿ç”¨ç‡
- ãƒ†ãƒ¼ãƒ–ãƒ«ã‚µã‚¤ã‚º
- æ¥ç¶šæ•°

**ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ç›£è¦–**:

- å­¤ç«‹ãƒ¬ã‚³ãƒ¼ãƒ‰ã®æ¤œå‡º
- åˆ¶ç´„é•åã®ç¢ºèª
- ãƒ‡ãƒ¼ã‚¿å“è³ªãƒã‚§ãƒƒã‚¯

### 2. å®šæœŸãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹

**æ—¥æ¬¡ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹**:

- çµ±è¨ˆæƒ…å ±æ›´æ–°
- ãƒ­ã‚°ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³
- ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å®Ÿè¡Œ

**é€±æ¬¡ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹**:

- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å†æ§‹ç¯‰
- æ–­ç‰‡åŒ–è§£æ¶ˆ
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åˆ†æ

**æœˆæ¬¡ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹**:

- ãƒ‡ãƒ¼ã‚¿ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–
- å®¹é‡åˆ†æ
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»

---

## ğŸ“š å‚è€ƒæƒ…å ±

### é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [README.md](../README.md) - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦
- [docs/system-design.md](./system-design.md) - ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆ
- [DATABASE_QUICK_REF.md](../DATABASE_QUICK_REF.md) - ã‚¯ã‚¤ãƒƒã‚¯ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

### æŠ€è¡“ä»•æ§˜

- **Prisma**: https://www.prisma.io/docs
- **PostgreSQL**: https://www.postgresql.org/docs/
- **NestJS**: https://docs.nestjs.com/

---

_æœ€çµ‚æ›´æ–°: 2025å¹´1æœˆ_  
_ä½œæˆè€…: çŒ«ç”Ÿä½“ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ é–‹ç™ºãƒãƒ¼ãƒ _
